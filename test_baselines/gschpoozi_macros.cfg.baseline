#######################################
# G-code macros
# Generated by gschpoozi v2.0
# 2025-12-20 08:24:39
#
# DO NOT EDIT - Changes will be overwritten
# Use user-overrides.cfg for customizations
#######################################

[gcode_macro _BED_MESH]
description: Run bed mesh with appropriate method for probe type
gcode:
    {% set cfg = printer["gcode_macro _MACRO_CONFIG"] %}
    {% set MODE = params.MODE|default("adaptive")|lower %}

    {% if MODE == "none" %}
        M117 Skipping mesh
    {% elif MODE == "saved" %}
        BED_MESH_PROFILE LOAD=default
    {% elif MODE == "adaptive" %}
        # Adaptive mesh - only mesh print area
        {% if cfg.probe_type in ['beacon', 'cartographer', 'btt_eddy'] %}
            BED_MESH_CALIBRATE METHOD={cfg.eddy_mesh_method} ADAPTIVE=1
        {% else %}
            BED_MESH_CALIBRATE ADAPTIVE=1
        {% endif %}
    {% else %}
        # Full mesh
        {% if cfg.probe_type in ['beacon', 'cartographer', 'btt_eddy'] %}
            BED_MESH_CALIBRATE METHOD={cfg.eddy_mesh_method}
        {% else %}
            BED_MESH_CALIBRATE
        {% endif %}
    {% endif %}
